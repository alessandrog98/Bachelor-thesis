%CLASSE DOCUMENTO - LINGUA E DIMENSIONE FONT
\documentclass[corpo=11pt,numerazioneromana]{toptesi}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% INCLUSIONE PACCHETTI
\usepackage[classica]{topfront}
\usepackage[utf8]{inputenc} %utf8
\usepackage[italian]{babel}
\usepackage[T1]{fontenc}
\usepackage{blindtext}
\usepackage{graphicx,wrapfig}
\usepackage{booktabs}
\usepackage{lmodern}
\usepackage{varioref}
\usepackage{url}
\usepackage{array}
\usepackage{paralist}{\obeyspaces\global\let =\space}
\usepackage{verbatim}
\usepackage{subfig}
\usepackage{tabularx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{float}
\usepackage{amssymb}
\usepackage{multicol}
\usepackage{multirow}
\usepackage{listings}
\usepackage[pass]{geometry}
\usepackage[figuresright]{rotating}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{amsmath}
\usepackage[babel]{csquotes}
\usepackage{hyperref}
\usepackage[backend=biber,bibencoding=ascii]{biblatex}
\usepackage[dvipsnames]{xcolor}
\usepackage{pythontex} 
\usepackage{pythonhighlight}

\definecolor{bleudefrance}{rgb}{0.19, 0.55, 0.91}
\definecolor{amethyst}{rgb}{0.6, 0.4, 0.8}
\definecolor{airforceblue}{rgb}{0.36, 0.54, 0.66}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
% color def
\definecolor{darkred}{rgb}{0.6,0.0,0.0}
\definecolor{darkgreen}{rgb}{0,0.50,0}
\definecolor{lightblue}{rgb}{0.0,0.42,0.91}
\definecolor{orange}{rgb}{0.99,0.48,0.13}
\definecolor{grass}{rgb}{0.18,0.80,0.18}
\definecolor{pink}{rgb}{0.97,0.15,0.45}


% listings
\usepackage{listings}

% General Setting of listings
\lstdefinestyle{Python}{
  language = Python,
  aboveskip=1em,
  breaklines=true,
  captionpos=b,
  escapeinside={\%*}{*)},
  frame=single,
  numbers=left,
  numbersep=6pt,
  xleftmargin=\parindent,
  numberstyle=\scriptsize\ttfamily,
  basicstyle=\scriptsize\ttfamily,
  backgroundcolor=\color{white},
  commentstyle=\color{darkgreen}\slshape,
  keywords=[2]{rop,rop1,rop2,p,libc,lib,payload,elf,list,n,e,c,ggod_str,where_to_write,username,password,conf,csu_gadget_comp,csu_gadget_pop,offset,binsh,
  puts_lib_idx,scanf_lib_idx,secret_off,pop_rbp,add_mmrax_rbp,change_usr_lib_idx,buffer,pop_r12_r13,pop_r13,pop_rdi,pop_rsi,pop_r15,mov_rax_r13,mov_mmr13_r12,
  add_mbr15_r14b,xor_rdx,syscall,good_str,bad_str,badchars,binary,library,pop_rsp,csu_gadget_comp,ret_pos,csu_gadget_compl},
  keywords=[4]{p64,print,set_env,transform_badchars,recvlines,sendline,recvuntil,ord,chr,critical,raw,call,fit,interactive,execve,next,search,b,f,ELF,ROP,process,
  u64,rstrip,ljust,send,recvline,decode,make_good_str,hex,range,len,to_bytes},
  keywords=[5]{dict,int,float},
  keywordstyle=[2]\color{Bittersweet},
  keywordstyle=\color{codepurple},
  keywordstyle=[4]\color{RoyalBlue},
  keywordstyle=[5]\color{Dandelion},
  stringstyle=\color{LimeGreen}
}

\lstdefinestyle{C lang}{
  belowcaptionskip=1\baselineskip,
  breaklines=true,
  frame=single,
  numbersep=6pt,
  xleftmargin=\parindent,
  language=C,
  showstringspaces=false,
  basicstyle=\scriptsize\ttfamily,
  keywordstyle=\bfseries\color{amethyst},
  commentstyle=\itshape\color{purple!40!black},
  stringstyle=\color{LimeGreen},
  numberstyle=\scriptsize\ttfamily,
  keywords=[2]{new_psw,over,password,conf,username,usr,psw,new_usr,str1,str2,str3,scelta},
  keywords=[4]{change_password,memset,puts,read,check,printf,new_credentials,change_username,secret_function,execve,new_credentials_canary,main,scanf},
  keywordstyle=[2]\color{Bittersweet},
  keywordstyle=\color{codepurple},
  keywordstyle=[4]\color{RoyalBlue},
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% CONFIGURAZIONE LINK E RIFERIMENTI
\hypersetup{%
    pdfpagemode={UseOutlines},
    bookmarksopen,
    pdfstartview={FitH},
    colorlinks,
    linkcolor={black}, %COLORE DEI RIFERIMENTI AL TESTO
    citecolor={blue}, %COLORE DEI RIFERIMENTI ALLE CITAZIONI
    urlcolor={blue} %COLORI DEGLI URL
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% CONFIGURAZIONE LISTATI/CODICE - CANCELLARE SE NON NECESSARIO
% PYTHON - BIANCO E NERO
\lstset{%
	captionpos=b,
	language=Python,
	basicstyle =\small\ttfamily,
	keywordstyle=\color{black}\bfseries,
	breaklines=true,
	breakatwhitespace=true,
	frame=lines,
	numbers=left,
	numberstyle=\footnotesize,
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% FRENCHSPACING VA _SEMPRE_ ABILITATO PER DOCUMENTI IN ITALIANO
\frenchspacing

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%DEFINIZIONE SEZIONI IN NUMERAZIONE ROMANA
%ELENCO DEI LISTATI/CODICI
\makeatletter
\newcommand\listofcodes{%
 \iffrontmatter\else\frontmattertrue\fi
 \if@openright\cleardoublepage\else\clearpage\fi
 % change the meaning of \chapter in a group
 \begingroup\def\chapter##1{\@schapter}
 \phantomsection % for the hyperlink
 \addcontentsline{toc}{chapter}{Elenco dei listati}
 \lstlistoflistings
 \endgroup
} 
\makeatother

\addto\captionsitalian{%
  \renewcommand{\lstlistlistingname}{Elenco dei listati}%
  \renewcommand{\lstlistingname}{Listato}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% INFORMAZIONI PDF - PERSONALIZZARE
\pdfinfo{%
  /Title    (ROP - Return Oriented Programming)
  /Author   (Alessandro Gasparello\\878169)
  /Subject  ()
  /Keywords ()
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% LISTA DEI CAPITOLI DA INCLUDERE - PERSONALIZZARE
\includeonly{%
chapter/chap_one,%
chapter/chap_two,%
chapter/chap_three,%
chapter/chap_four,%
chapter/chap_five,%
chapter/appendix,%
}

% FILE DI BIBLIOGRAFIA
\addbibresource{bibliography/bibliography.bib}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% INIZIO DOCUMENTO
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% FRONTESPIZIO - PERSONALIZZARE
% ELIMINATE LE VOCI CHE NON VI SERVONO

% UNIVERSITA - NOME
\ateneo{Università Ca' Foscari Venezia}

% FACOLTA - DICITURA - CANCELLARE O DECOMMENTARE
% \FacoltaDi{Facoltà di}
% % FACOLTA - NOME
% \facolta{Informatica}

% CORSO DI LAUREA - DICITURA (MANTENERE LO SPAZIO) - CANCELLARE O DECOMMENTARE
%\CorsoDiLaureaIn{Master of Science in }
% CORSO DI LAUREA - NOME
\corsodilaurea{Informatica - Percorso Data Science}

% TIPOLOGIA TESI
\TesiDiLaurea{Tesi di Laurea}

% TITOLO
\titolo{Analisi e sperimentazione di attacchi Return Oriented Programming (ROP)}

% SOTTOTITOLO
%\sottotitolo{Un trattato di toccante urgenza}

% RELATORE/I - DICITURA - CANCELLARE SE UN SOLO RELATORE
%\AdvisorName{Relatori}
% RELATORE - PROF. NOME E COGNOME
\relatore{prof.\ Riccardo Focardi}

% TUTORE AZIENDALE - TITOLO NOME E COGNOME
% \tutoreaziendale{Ing. Carlino Cane}
% TUTORE AZIENDALE - DICITURA//AZIENDA
% \NomeTutoreAziendale{Tutore Aziendale\\FeelGood Inc}

% CANDIDATO - DICITURA (MANTENERE I DUE PUNTI) - CANCELLARE O DECOMMENTARE
%\CandidateName{Candidate:}

% CANDIDATO - NOME E COGNOME
\candidato{Alessandro Gasparello \\ Matricola 878169}
% CANDIDATA - ELIMINARE O SOSTITUIRE CON IL PRECEDENTE
%\candidata{Tinasa de Tinasis} 
% SECONDO CANDIDATO - ELIMINARE O DECOMMENTARE
%secondocandidato{Bombo de Bombis}
%secondacandidata{Bomba de Bombis}

% LOGO UNIVERSITA
\logosede[0.35\textwidth]{images/unive2.png}

% DATA - MESE ANNO
% \sedutadilaurea{Anno Accademico 2021/2022}

\sedutadilaurea{\small{\textbf{Anno Accademico}} \space \\ {2021/2022}}

\frontespizio

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%INTERLINEA - DEFAULT 1 - NON ESAGERATE, NON SUPERATE MAI 1.3 ;)
%\interlinea{1.2}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\frontmatter

% DEDICA - PERSONALIZZARE
% VSPACE - PROPORZIONE USATA PER CENTRATURA VERTICALE DEL TESTO
% FLUSHRIGHT - ALLINEAMENTO ORIZZONTALE A DESTRA
% \vspace*{\stretch{1}}
% \begin{flushright}
% \noindent
% All'amato me stesso
% \end{flushright}
% \vspace*{\stretch{6}}
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% RINGRAZIAMENTI - PERSONALIZZARE
\ringraziamenti
Ringrazio infinitamente Emily per avermi sempre sostenuto e non aver mai smesso di credere in me e nelle mie potenzialità. 
Ringrazio tanto la mia famiglia che ha cercato per quanto possibile di aiutarmi e supportarmi soprattutto nei momenti più difficili. Ringrazio tantissimo anche i miei due
zii che sono stati dal primo giorno i miei fan e supporter numero uno in questa esperienza. Ringrazio i miei amici per avermi sopportato e sollevato nei momenti più intensi di questo lungo e tortuoso viaggio. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% ABSTRACT - PERSONALIZZARE
\sommario
Nell’ultimo ventennio, la tecnica di attacco informatico denominata Return Oriented Programming (ROP) si è distinta dalle
altre grazie alle sue capacità di adattamento alle moderne architetture dei processori e di elusione delle tradizionali 
strategie di difesa quali la NX/DEP (No-execute/ Data Execution Prevention) e la ASLR (Address Space Layout Randomization).\\  
In questo lavoro di tesi, inizialmente, verranno illustrati i concetti su cui si basa la ROP, quali ad esempio la sezione 
di memoria stack ed i principali registri del processore, necessari a comprendere interamente le sue potenzialità.\\ 
Successivamente, verrà analizzato l’impiego e la sperimentazione di essa mediante dei test effettuati su del codice 
in determinate condizioni, sfruttando alcune delle più conosciute e critiche vulnerabilità. Ogni test realizzato avrà 
come obiettivo l’applicazione personalizzata della tecnica in base alla situazione, per poter poi sviluppare efficaci 
attacchi anche in presenza di diversi sistemi di difesa. In conclusione, verranno proposti dei metodi di difesa per proteggere 
il codice da attacchi realizzati con questa potente ed efficace tecnica.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% INDICI - ELIMINARE GLI INDICI NON NECESSARI

% INDICE GENERALE
\tableofcontents

% INDICE DELLE FIGURE
% \listoffigures

% INDICE DELLE TABELLE
% \listoftables

% INDICE DEI CODICI
% \listofcodes

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\mainmatter

% INCLUSIONE FILE CAPITOLI - PERSONALIZZARE - TENERE COERENTE CON LISTA IN ALTO
\include{chapter/chap_one}
\include{chapter/chap_two}
\include{chapter/chap_three}
\include{chapter/chap_four}
\include{chapter/chap_five}

\appendix
% INCLUSIONE APPENDICI - - PERSONALIZZARE - TENERE COERENTE CON LISTA IN ALTO
\include{chapter/app_a}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% BIBLIOGRAFIA
\phantomsection
\addcontentsline{toc}{chapter}{\refname}
\nocite{*}
\printbibliography

\end{document}
